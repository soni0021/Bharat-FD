{"ast":null,"code":"var Format,\n  Leaf,\n  LinkedList,\n  dom,\n  _,\n  __hasProp = {}.hasOwnProperty,\n  __extends = function (child, parent) {\n    for (var key in parent) {\n      if (__hasProp.call(parent, key)) child[key] = parent[key];\n    }\n    function ctor() {\n      this.constructor = child;\n    }\n    ctor.prototype = parent.prototype;\n    child.prototype = new ctor();\n    child.__super__ = parent.prototype;\n    return child;\n  };\n_ = require('lodash');\ndom = require('../lib/dom');\nFormat = require('./format');\nLinkedList = require('../lib/linked-list');\nLeaf = function (_super) {\n  __extends(Leaf, _super);\n  Leaf.ID_PREFIX = 'leaf-';\n  Leaf.isLeafNode = function (node) {\n    return dom(node).isTextNode() || node.firstChild == null;\n  };\n  function Leaf(node, formats) {\n    this.node = node;\n    this.formats = _.clone(formats);\n    this.id = _.uniqueId(Leaf.ID_PREFIX);\n    this.text = dom(this.node).text();\n    this.length = this.text.length;\n  }\n  Leaf.prototype.deleteText = function (offset, length) {\n    var textNode;\n    if (!(length > 0)) {\n      return;\n    }\n    this.text = this.text.slice(0, offset) + this.text.slice(offset + length);\n    this.length = this.text.length;\n    if (dom.EMBED_TAGS[this.node.tagName] != null) {\n      textNode = this.node.ownerDocument.createTextNode(this.text);\n      return this.node = dom(this.node).replace(textNode);\n    } else {\n      return dom(this.node).text(this.text);\n    }\n  };\n  Leaf.prototype.insertText = function (offset, text) {\n    var textNode;\n    this.text = this.text.slice(0, offset) + text + this.text.slice(offset);\n    if (dom(this.node).isTextNode()) {\n      dom(this.node).text(this.text);\n    } else {\n      textNode = this.node.ownerDocument.createTextNode(text);\n      if (this.node.tagName === dom.DEFAULT_BREAK_TAG) {\n        this.node = dom(this.node).replace(textNode);\n      } else {\n        this.node.appendChild(textNode);\n        this.node = textNode;\n      }\n    }\n    return this.length = this.text.length;\n  };\n  return Leaf;\n}(LinkedList.Node);\nmodule.exports = Leaf;","map":null,"metadata":{},"sourceType":"script"}